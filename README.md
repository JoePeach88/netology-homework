[üîô –Ω–∞ –≥–ª–∞–≤–Ω—É—é](https://github.com/YeezyWhy/netology-homework/tree/main)

# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –ø–æ —Ç–µ–º–µ "SQL. –ß–∞—Å—Ç—å 2". –ì–∞–µ–≤ –ï–≥–æ—Ä

## –ó–∞–¥–∞–Ω–∏–µ 1

–û–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º –ø–æ–ª—É—á–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∞–≥–∞–∑–∏–Ω–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è –±–æ–ª–µ–µ 300 –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –∏ –≤—ã–≤–µ–¥–∏—Ç–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: 
- —Ñ–∞–º–∏–ª–∏—è –∏ –∏–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏–∑ —ç—Ç–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞;
- –≥–æ—Ä–æ–¥ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–∞;
- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∑–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã—Ö –≤ —ç—Ç–æ–º –º–∞–≥–∞–∑–∏–Ω–µ.

## –†–µ—à–µ–Ω–∏–µ

```sql
SELECT s.first_name, s.last_name, c2.city , s.staff_id, count(c.customer_id)
from sakila.staff s 
join store s2 ON s.store_id = s2.store_id 
JOIN customer c on c.store_id  = s2.store_id 
join address a on a.address_id = s2.address_id 
join city c2 on a.city_id = c2.city_id 
GROUP BY s.staff_id, c2.city_id 
HAVING count(c.customer_id) > 300;
```

![alt text](/img/img1.png)

## –ó–∞–¥–∞–Ω–∏–µ 2

–ü–æ–ª—É—á–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏–ª—å–º–æ–≤, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ —Å—Ä–µ–¥–Ω–µ–π –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö —Ñ–∏–ª—å–º–æ–≤.

## –†–µ—à–µ–Ω–∏–µ

```sql
SELECT COUNT(f.title)
from sakila.film f 
where `length` > 
	(SELECT AVG(`length`)
	from sakila.film )
```

![alt text](/img/img2.png)

## –ó–∞–¥–∞–Ω–∏–µ 3

–ü–æ–ª—É—á–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∑–∞ –∫–∞–∫–æ–π –º–µ—Å—è—Ü –±—ã–ª–∞ –ø–æ–ª—É—á–µ–Ω–∞ –Ω–∞–∏–±–æ–ª—å—à–∞—è —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π, –∏ –¥–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∞—Ä–µ–Ω–¥ –∑–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü.

## –†–µ—à–µ–Ω–∏–µ

```sql
SELECT DATE_FORMAT(p.payment_date, '%Y-%M') AS –î–∞—Ç–∞ , (sum(p.amount )) AS –°—É–º–º–∞ , count((p.rental_id )) AS –ê—Ä–µ–Ω–¥
FROM sakila.payment p 
GROUP BY –î–∞—Ç–∞
ORDER BY –°—É–º–º–∞ DESC
LIMIT 1;
```

![alt text](/img/img3.png)
